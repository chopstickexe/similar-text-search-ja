# similar-text-search-ja
Find similar sentences using huggingface/transformers

## Usage

```
# Clone this repository

$ docker build -t similar-text-search-ja .
$ docker run -it --gpus all -v $PWD:/opt/app -v ~/.gitconfig:/etc/gitconfig --rm similar-text-search-ja

# Attach to the container

# python -m venv .venv
# sourse .venv/bin/activate 

(.venv) # pip install -r requirements.txt
(.venv) # pip install transformers["ja"]  # Could someone tell how I could write this in requirements.txt?
```

## How to try similar text search mlit data and Elasticsearch More Like This queries

```
# Clone this repository
# Place a csv file generated by mlit.crawler under data/mlit

$ docker-compose up
$ docker exec -it python01 bash

# python -m venv .venv
# sourse .venv/bin/activate 
(.venv) # pip install -r requirements.txt
(.venv) # python similar-text-search-ja/es/index_mlit.py -c es01:9200 mlit data/mlit/mlit.20200919.csv
```

Open `http://kib.localhost/app/dev_tools#/console` from your browser and try this query:
```
GET mlit/_search
{
  "query": {
    "more_like_this": {
      "fields": [
        "申告内容の要約"
      ],
      "like": "ステアリングが動かない",
      "min_term_freq" : 1
    }
  }
}
```